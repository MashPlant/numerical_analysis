---
title: "Chap3 线性方程组的直接解法"
author: "李晨昊 2017011466"
date: "2019-3-9"
output:
  pdf_document:
    latex_engine: xelatex
    number_sections: yes
    toc: yes
  word_document:
    toc: yes
  html_document:
    toc: yes
header-includes: \usepackage{ctex} \usepackage{graphicx} \usepackage{amssymb}
---

\newpage

# 运行代码

环境要求：rust，gnuplot

运行代码
```bash
cargo run
```

# q3.6
## 任务
使用Cholesky分解算法求解方程$H_nx=b$，其中$H_n$为$n$阶Hilbert矩阵，$b=H_nx$，$x$为$n$个元素全为$1$的向量

## 解题思路
按照课本上描述的算法的思路编写代码即可

Cholesky分解算法求解方程分为三步
1. 对正定矩阵$A$进行Cholesky分解，得到$A=LL^T$，其中$L$为所有对角线元素为正数的下三角阵
2. 求解方程$Ly=b$，这直接与高斯消元法的回代过程方向相反，思路类似
3. 求解方程$L^Tx=y$，这直接就是高斯消元法的回代过程
   
## 实验结果
1. $n=10$，计算$\|r\|_{\infty},\|\Delta x\|_{\infty}$

计算得到解x如下
```
solve = [0.9999999987384126, 1.0000001083531875, 0.9999977024253508,
1.0000208143090212, 0.9999010002715109, 1.000271511848817, 
0.9995554149286598, 1.0004289087352602, 0.9997751597216618, 
1.0000493815113927]
```
计算得$\|r\|_{\infty},\|\Delta x\|_{\infty}$如下
```
inf norm of delta b = 0.0000000000000004440892098500626 // 残差
inf norm of delta x = 0.00044458507134015335 // 误差
```

2. 在右端施加$10^{-7}$的扰动，观察残差和误差的变化情况

扰动后输出如下
```
inf norm of delta b = 0.0000000000000004440892098500626
inf norm of delta x = 0.700708270017177
```
可见残差没有明显变化，但是误差显著放大了

3. 改变$n$为$8,12$，观察残差和误差的变化情况，这说明了什么?

完整输出如下
```
n = 10
before disturbance
solve = [0.9999999987384126, 1.0000001083531875, 0.9999977024253508, 
1.0000208143090212, 0.9999010002715109, 1.000271511848817, 0.9995554149286598, 
1.0004289087352602, 0.9997751597216618, 1.0000493815113927]
inf norm of delta b = 0.0000000000000004440892098500626
inf norm of delta x = 0.00044458507134015335
after disturbance
inf norm of delta b = 0.0000000000000004440892098500626
inf norm of delta x = 0.700708270017177
problem cond = 20523523.482441533

n = 8
before disturbance
solve = [0.9999999999709857, 1.0000000015465562, 0.9999999798871754, 1.000000108508144, 
0.9999997085792339, 1.000000411543821, 0.9999997075936138, 1.0000000823906543]
inf norm of delta b = 0.0000000000000002220446049250313
inf norm of delta x = 0.0000004115438210217093
after disturbance
inf norm of delta b = 0.0000000000000002220446049250313
inf norm of delta x = 0.02162222989802176
problem cond = 587661.341350607

n = 12
before disturbance
solve = [0.9999999669702844, 1.0000041657324705, 0.9998694415563627, 1.0017744011217633, 
0.9870167549994316, 1.0569612331621385, 0.8414790066453739, 1.2866651456630795, 
0.6641941895670194, 1.2457673980931956, 0.8978781383305862, 1.0183901800169004]
inf norm of delta b = 0.0000000000000004440892098500626
inf norm of delta x = 0.33580581043298063
after disturbance
inf norm of delta b = 0.0000000000000005551115123125783
inf norm of delta x = 23.620154933680745
problem cond = 732983193.7320421
```
可见扰动之后误差的随着$n$的变大而显著增大，这是因为$H_n$的条件数随着$n$的增大而迅速增大导致的。

分别计算8，10,12阶Hilbert矩阵的条件数得到：

$$cond(H_8)_{\inf} = 33872790819.49471$$
$$cond(H_{10})_{\inf} = 35353724553756.42$$
$$cond(H_{12})_{\inf} = 3.798320122691213*10^{16}$$

对比之前对$b$施加扰动得到的问题条件数，验证了问题条件数总是小于等于矩阵条件数，也能发现问题条件数往往与矩阵条件数正相关。

## 心得体会
矩阵条件数的大小能显著影响到解线性方程组得到的解的准确程度，实际问题中应该尽量降低线性方程组中的矩阵的条件数，例如改变矩阵构造方法，在方程两边同乘一个矩阵等；如果没有办法解决这个问题，就只能尝试减小让方程的右端项的误差，或者使用更高精度的浮点数类型来减少计算过程中误差的影响。